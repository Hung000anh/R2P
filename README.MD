# R2P â€“ Project Directory Tree Prompt Builder

## 1. Má»¥c Ä‘Ã­ch

R2P lÃ  á»©ng dá»¥ng xÃ¢y dá»±ng báº±ng Streamlit cho phÃ©p:

* QuÃ©t vÃ  hiá»ƒn thá»‹ cáº¥u trÃºc thÆ° má»¥c cá»§a má»™t project.
* Chá»n file nguá»“n trá»±c tiáº¿p tá»« giao diá»‡n tree.
* Táº¡o ná»™i dung tá»•ng há»£p (project tree + mÃ£ nguá»“n Ä‘Ã£ chá»n).
* Sinh prompt hoÃ n chá»‰nh Ä‘á»ƒ sá»­ dá»¥ng cho LLM (ChatGPT, Claude, Geminiâ€¦).

á»¨ng dá»¥ng phá»¥c vá»¥ má»¥c tiÃªu phÃ¢n tÃ­ch code base, review kiáº¿n trÃºc, sinh tÃ i liá»‡u, hoáº·c táº¡o prompt AI má»™t cÃ¡ch cÃ³ cáº¥u trÃºc.

---

## 2. TÃ­nh nÄƒng chÃ­nh

1. Nháº­p Ä‘Æ°á»ng dáº«n thÆ° má»¥c dá»± Ã¡n.
2. Tá»± Ä‘á»™ng xÃ¢y dá»±ng cÃ¢y thÆ° má»¥c (directory tree).
3. Cho phÃ©p ignore theo Ä‘uÃ´i file (.py, .js, .md, â€¦).
4. Chá»n nhiá»u file tá»« tree báº±ng checkbox.
5. Hiá»ƒn thá»‹ mÃ£ nguá»“n cÃ³ syntax highlighting.
6. ThÃªm System Message vÃ  User Message.
7. Sinh khá»‘i ná»™i dung chuáº©n gá»“m:

   * SYSTEM MESSAGE
   * USER MESSAGE
   * PROJECT TREE
   * MÃƒ NGUá»’N ÄÃƒ CHá»ŒN
8. Sao chÃ©p toÃ n bá»™ ná»™i dung chá»‰ vá»›i má»™t nÃºt báº¥m.

---

## 3. Cáº¥u trÃºc thÆ° má»¥c

```
ğŸ“¦ R2P
â”œâ”€â”€ ğŸ“ assets/
â”‚   â””â”€â”€ prompt.ico
â”œâ”€â”€ ğŸ“ prompt/
â”‚   â””â”€â”€ builder.py
â”œâ”€â”€ ğŸ“ services/
â”‚   â”œâ”€â”€ files.py
â”‚   â””â”€â”€ tree.py
â”œâ”€â”€ ğŸ“ ui/
â”‚   â”œâ”€â”€ content.py
â”‚   â”œâ”€â”€ inputs.py
â”‚   â”œâ”€â”€ sidebar.py
â”‚   â””â”€â”€ tree.py
â”œâ”€â”€ app.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ run.bat
â””â”€â”€ state.py
```

---

## 4. Kiáº¿n trÃºc há»‡ thá»‘ng

### 4.1 app.py â€“ Entry Point

* Cáº¥u hÃ¬nh layout Streamlit (wide).
* Khá»Ÿi táº¡o session state.
* Render cÃ¡c thÃ nh pháº§n giao diá»‡n.
* Chia layout 2 cá»™t:

  * Cá»™t trÃ¡i: ná»™i dung chÃ­nh.
  * Cá»™t pháº£i: tree selector.

Luá»“ng xá»­ lÃ½:

1. init_state()
2. Nháº­p project path
3. Render sidebar
4. Render tree selector
5. Render ná»™i dung chÃ­nh

---

### 4.2 state.py â€“ Quáº£n lÃ½ tráº¡ng thÃ¡i

Quáº£n lÃ½ cÃ¡c biáº¿n trong `st.session_state`:

* ignore_exts
* checked_files
* tree
* tree_lines
* system_message
* user_message

TÃ¡ch state riÃªng giÃºp trÃ¡nh logic ráº£i rÃ¡c trong UI.

---

### 4.3 services/

#### services/tree.py

Chá»©c nÄƒng:

* scan_extensions(): quÃ©t toÃ n bá»™ Ä‘uÃ´i file.
* build_tree(): xÃ¢y dá»±ng cáº¥u trÃºc thÆ° má»¥c dáº¡ng dictionary.
* tree_to_nodes(): chuyá»ƒn sang format dÃ¹ng cho streamlit-tree-select.
* render_tree_pretty(): xuáº¥t tree dáº¡ng ASCII.
* collect_folder_values(): phá»¥c vá»¥ expand tree.

Tá»± Ä‘á»™ng ignore:

* **pycache**
* venv
* .venv
* thÆ° má»¥c báº¯t Ä‘áº§u báº±ng dáº¥u cháº¥m

#### services/files.py

* read_file(): Ä‘á»c file UTF-8, bá» qua lá»—i encoding.
* guess_language(): suy Ä‘oÃ¡n ngÃ´n ngá»¯ Ä‘á»ƒ highlight code.

---

### 4.4 ui/

TÃ¡ch UI thÃ nh nhiá»u module Ä‘á»™c láº­p:

* inputs.py: nháº­p Ä‘Æ°á»ng dáº«n dá»± Ã¡n.
* sidebar.py: nháº­p System / User message.
* tree.py: hiá»ƒn thá»‹ vÃ  chá»n file tá»« tree.
* content.py: hiá»ƒn thá»‹ tá»•ng quan vÃ  mÃ£ nguá»“n.

Thiáº¿t káº¿ theo hÆ°á»›ng:

* UI khÃ´ng chá»©a logic xá»­ lÃ½ náº·ng.
* Logic Ä‘áº·t trong services.
* Prompt builder tÃ¡ch riÃªng.

---

### 4.5 prompt/builder.py

HÃ m `build_project_overview()` táº¡o ná»™i dung tá»•ng há»£p theo cáº¥u trÃºc chuáº©n:

```
===== SYSTEM MESSAGE =====
...

===== USER MESSAGE =====
...

===== PROJECT TREE =====
ğŸ“¦ project_name
â”œâ”€â”€ ...

===== MÃƒ NGUá»’N ÄÃƒ CHá»ŒN =====
--- FILE: path/to/file ---
...
```

ÄÃ¢y lÃ  pháº§n cá»‘t lÃµi Ä‘á»ƒ táº¡o prompt dÃ¹ng cho LLM.

---

## 5. YÃªu cáº§u há»‡ thá»‘ng

* Python 3.9 trá»Ÿ lÃªn
* pip

Dependencies:

* streamlit
* streamlit-tree-select
* st-copy-to-clipboard

---

## 6. CÃ i Ä‘áº·t

CÃ i thÆ° viá»‡n:

```
pip install -r requirements.txt
```

---

## 7. Cháº¡y á»©ng dá»¥ng

### CÃ¡ch 1

```
streamlit run app.py
```

### CÃ¡ch 2 (Windows)

Cháº¡y:

```
run.bat
```

Script sáº½:

1. Táº¡o virtualenv náº¿u chÆ°a tá»“n táº¡i.
2. CÃ i dependency.
3. Cháº¡y app táº¡i port 8502.

---

## 8. CÃ¡ch sá»­ dá»¥ng

1. Má»Ÿ á»©ng dá»¥ng.
2. Nháº­p Ä‘Æ°á»ng dáº«n project.
3. Chá»n ignore extension náº¿u cáº§n.
4. Tick cÃ¡c file muá»‘n Ä‘Æ°a vÃ o prompt.
5. Nháº­p System / User message trong sidebar.
6. Nháº¥n â€œÃp dá»¥ngâ€.
7. Nháº¥n â€œSao chÃ©pâ€ Ä‘á»ƒ copy toÃ n bá»™ ná»™i dung.

---

## 9. á»¨ng dá»¥ng thá»±c táº¿

* PhÃ¢n tÃ­ch kiáº¿n trÃºc project báº±ng AI.
* Code review tá»± Ä‘á»™ng.
* Sinh tÃ i liá»‡u README.
* Refactor gá»£i Ã½.
* Chuáº©n bá»‹ prompt lá»›n cÃ³ cáº¥u trÃºc rÃµ rÃ ng.
* Há»— trá»£ lÃ m viá»‡c vá»›i code base lá»›n.

---

## 10. HÆ°á»›ng má»Ÿ rá»™ng

* Há»— trá»£ ignore theo pattern (.gitignore).
* ThÃªm bá»™ lá»c theo kÃ­ch thÆ°á»›c file.
* ThÃªm cháº¿ Ä‘á»™ chá»‰ xuáº¥t tree.
* ThÃªm cháº¿ Ä‘á»™ export ra Markdown.
* TÃ­ch há»£p trá»±c tiáº¿p API LLM.
* ThÃªm tÃ¬m kiáº¿m file trong tree.

---

## 11. Tá»•ng káº¿t

R2P lÃ  cÃ´ng cá»¥ trá»±c quan hÃ³a vÃ  trÃ­ch xuáº¥t mÃ£ nguá»“n cÃ³ cáº¥u trÃºc, Ä‘Æ°á»£c thiáº¿t káº¿ module hÃ³a rÃµ rÃ ng (UI â€“ Services â€“ Prompt Builder â€“ State). Má»¥c tiÃªu chÃ­nh lÃ  táº¡o má»™t workflow hiá»‡u quáº£ Ä‘á»ƒ chuáº©n bá»‹ prompt AI tá»« báº¥t ká»³ project nÃ o.
